document.addEventListener("DOMContentLoaded",function(e){function t(e){var t=!0;return[].forEach.call(e,function(e){/^\s*$/.test(e.value)&&(e.parentElement.classList.add("has-error"),t=!1)}),t}function n(e){[].forEach.call(e,function(e,t){var n=document.createElement("div");n.className="att";var a=document.createElement("span");a.className="content",a.textContent=e.name,n.appendChild(a);var r=document.createElement("span");r.className="glyphicon glyphicon-remove",r.onclick=function(){n.remove(),p.splice(p.indexOf(e),1)},n.appendChild(r),l.appendChild(n)})}var a=document.getElementById("tipform"),r=a.querySelector("button"),o=document.getElementById("uploader"),c=document.querySelector(".dropbox .inner-box"),i=document.querySelector(".file-select .cross"),l=document.querySelector(".attlist"),d=document.querySelector(".backdrop"),s=document.getElementById("new_tip_errmsg");c.addEventListener("dragover",function(e){e.preventDefault()});var u=0;c.addEventListener("dragenter",function(e){u++,c.classList.add("active")}),c.addEventListener("dragleave",function(e){u--,u||c.classList.remove("active")});var p=[];c.addEventListener("drop",function(e){e.preventDefault(),u=0,c.classList.remove("active");var t=e.dataTransfer;t.files&&t.files.length>0&&([].push.apply(p,t.files),n(t.files))}),i.addEventListener("click",function(){o.click()}),o.addEventListener("change",function(e){[].push.apply(p,o.files),n(o.files)}),r.addEventListener("click",function(e){e.preventDefault();var n=document.getElementById("title"),r=document.getElementById("content");if(!t([n,r]))return void(s.textContent="Required fields should be populated.");s.textContent="",d.style.display="block";var o=new FormData(a);[].forEach.call(p,function(e,t){o.append("file"+t,e)});var c=new XMLHttpRequest;c.open("POST","/tips/new"),c.onload=function(){setTimeout(function(){window.location.pathname="/tips"},2e3)},c.onerror=function(){try{var e=JSON.parse(c.response);s.textContent=e.message}catch(t){s.textContent="Unkown error."}},c.timeout=5e3,c.send(o)}),a.addEventListener("keyup",function(e){var t=e.srcElement||e.target;t.value&&t.parentElement.classList.remove("has-error")})});